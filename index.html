<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teleprompter – Acquisizione Immobiliare</title>

<style>
  body{
    margin:0;
    background:#0b0f17;
    color:#fff;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  }

  .container{
    display:grid;
    grid-template-columns: 1fr 1fr;
    height:100vh;
  }

  .controls{
    padding:20px;
    background:#121a27;
    display:flex;
    flex-direction:column;
    gap:14px;
  }

  textarea{
    flex:1;
    background:#0f1622;
    color:#fff;
    border:1px solid #2a3550;
    border-radius:10px;
    padding:14px;
    font-size:20px;
    line-height:1.4;
    resize:none;
  }

  button{
    padding:12px;
    border-radius:10px;
    border:none;
    cursor:pointer;
    font-size:16px;
    background:#2a6df4;
    color:white;
  }

  button.stop{background:#ff4d4d;}
  button.secondary{background:#2a3550;}

  .row{
    display:flex;
    gap:10px;
  }

  input[type=range]{
    width:100%;
  }

  .preview{
    position:relative;
    background:black;
    overflow:hidden;
  }

  video{
    width:100%;
    height:100%;
    object-fit:cover;
  }

  .prompter{
    position:absolute;
    bottom:-100%;
    width:100%;
    padding:40px;
    font-size:48px;
    line-height:1.3;
    text-align:center;
    background:linear-gradient(to top, rgba(0,0,0,.9), transparent);
    animation: scroll linear forwards;
  }

  @keyframes scroll{
    from{ bottom:-100%; }
    to{ bottom:100%; }
  }
</style>
</head>

<body>

<div class="container">

  <!-- CONTROLLI -->
  <div class="controls">
    <h2>Teleprompter – Acquisizione Immobiliare</h2>

    <textarea id="script">
Ciao, sono [NOME], consulente immobiliare.

Se stai pensando di vendere casa, probabilmente ti stai chiedendo:
"Quanto vale davvero il mio immobile oggi?"

Il mercato è cambiato, e una valutazione corretta fa la differenza
tra vendere bene o perdere tempo.

Scrivimi, ti spiego tutto senza impegno.
    </textarea>

    <div class="row">
      <button id="rec">▶️ REC</button>
      <button id="stop" class="stop">⏹ STOP</button>
    </div>

    <div>
      Velocità scroll
      <input type="range" id="speed" min="20" max="120" value="60">
    </div>

    <div>
      Zoom testo
      <input type="range" id="zoom" min="24" max="72" value="48">
    </div>

    <button id="download" class="secondary">⬇️ Scarica video</button>
  </div>

  <!-- PREVIEW -->
  <div class="preview">
    <video id="camera" autoplay muted></video>
    <div id="prompter" class="prompter"></div>
  </div>

</div>

<script>
let mediaRecorder;
let recordedChunks = [];

const camera = document.getElementById("camera");
const prompter = document.getElementById("prompter");
const script = document.getElementById("script");
const speed = document.getElementById("speed");
const zoom = document.getElementById("zoom");

async function initCamera(){
  const stream = await navigator.mediaDevices.getUserMedia({
    video:{ facingMode:"user" },
    audio:true
  });
  camera.srcObject = stream;
  mediaRecorder = new MediaRecorder(stream);
  mediaRecorder.ondataavailable = e => recordedCh
